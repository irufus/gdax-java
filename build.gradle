apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'idea'

group = 'irufus'
description = 'Client for the GDAX API'
version = '0.9.0'

buildscript {
    repositories {
        mavenCentral()
        maven { url "http://repo.maven.apache.org/maven2" }
    }
}

repositories {
    maven { url "http://central.maven.org/maven2/"}
    maven { url "http://repo1.maven.org/maven2/" }
}
configurations {
    shade
    compile.extendsFrom shade
}

project.archivesBaseName = 'gdax-java'
project.applicationName = 'gdax-java'
project.mainClassName = "com.coinbase.exchange.api.GdaxApiApplication"

dependencies {
    compile 'junit:junit:latest.release'
    shade 'com.google.code.gson:gson:latest.release'
    shade 'org.slf4j:slf4j-api:latest.release'
    shade 'javax.websocket:javax.websocket-api:latest.release'
}

tasks.withType(Jar) {
    destinationDir = file("${rootDir}/build/")
}

// file will be generated here: build/gdax-java-1.0.jar
jar {
    /*doFirst {
        from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }
    }*/
    configurations.shade.each { dep ->
        from(project.zipTree(dep)){
            exclude 'META-INF', 'META-INF/**'
        }
    }
    manifest {
        attributes 'Main-Class': 'com.coinbase.exchange.api.GdaxApiApplication'
    }
    exclude 'META-INF/*.RSA', 'META-INF/*.SF','META-INF/*.DSA'
}